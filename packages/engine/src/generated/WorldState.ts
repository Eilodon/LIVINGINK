/**
 * AUTO-GENERATED by EIDOLON-V GENESIS - DO NOT EDIT MANUALLY
 * Generated: 2026-02-05T12:54:40.862Z
 * Source: packages/engine/scripts/schema.config.js
 */

export const MAX_ENTITIES = 10000;

export interface IWorldConfig {
    maxEntities?: number;
}

export class WorldState {
    public readonly maxEntities: number;
    
    // Entity State Flags (ACTIVE, DEAD, etc.)
    public readonly stateFlags: Uint8Array;
    
    // Component Buffers
    public readonly transform: Float32Array;
    public readonly transformBuffer: ArrayBuffer;
    public readonly transformView: DataView;
    public readonly physics: Float32Array;
    public readonly physicsBuffer: ArrayBuffer;
    public readonly physicsView: DataView;
    public readonly pigment: Float32Array;
    public readonly pigmentBuffer: ArrayBuffer;
    public readonly pigmentView: DataView;
    public readonly stats: Float32Array;
    public readonly statsBuffer: ArrayBuffer;
    public readonly statsView: DataView;
    public readonly input: Float32Array;
    public readonly inputBuffer: ArrayBuffer;
    public readonly inputView: DataView;
    public readonly skill: Float32Array;
    public readonly skillBuffer: ArrayBuffer;
    public readonly skillView: DataView;
    public readonly config: Float32Array;
    public readonly configBuffer: ArrayBuffer;
    public readonly configView: DataView;
    public readonly projectile: Float32Array;
    public readonly projectileBuffer: ArrayBuffer;
    public readonly projectileView: DataView;
    public readonly tattoo: Float32Array;
    public readonly tattooBuffer: ArrayBuffer;
    public readonly tattooView: DataView;

    constructor(config?: IWorldConfig) {
        this.maxEntities = config?.maxEntities ?? MAX_ENTITIES;
        
        // Allocate State Flags (1 byte per entity)
        this.stateFlags = new Uint8Array(this.maxEntities);
        
        // Allocate Component Buffers
        this.transformBuffer = new ArrayBuffer(this.maxEntities * 32);
        this.transform = new Float32Array(this.transformBuffer);
        this.transformView = new DataView(this.transformBuffer);
        this.physicsBuffer = new ArrayBuffer(this.maxEntities * 32);
        this.physics = new Float32Array(this.physicsBuffer);
        this.physicsView = new DataView(this.physicsBuffer);
        this.pigmentBuffer = new ArrayBuffer(this.maxEntities * 32);
        this.pigment = new Float32Array(this.pigmentBuffer);
        this.pigmentView = new DataView(this.pigmentBuffer);
        this.statsBuffer = new ArrayBuffer(this.maxEntities * 32);
        this.stats = new Float32Array(this.statsBuffer);
        this.statsView = new DataView(this.statsBuffer);
        this.inputBuffer = new ArrayBuffer(this.maxEntities * 16);
        this.input = new Float32Array(this.inputBuffer);
        this.inputView = new DataView(this.inputBuffer);
        this.skillBuffer = new ArrayBuffer(this.maxEntities * 16);
        this.skill = new Float32Array(this.skillBuffer);
        this.skillView = new DataView(this.skillBuffer);
        this.configBuffer = new ArrayBuffer(this.maxEntities * 32);
        this.config = new Float32Array(this.configBuffer);
        this.configView = new DataView(this.configBuffer);
        this.projectileBuffer = new ArrayBuffer(this.maxEntities * 16);
        this.projectile = new Float32Array(this.projectileBuffer);
        this.projectileView = new DataView(this.projectileBuffer);
        this.tattooBuffer = new ArrayBuffer(this.maxEntities * 16);
        this.tattoo = new Float32Array(this.tattooBuffer);
        this.tattooView = new DataView(this.tattooBuffer);
    }

    /**
     * Reset all component data to zero
     */
    reset(): void {
        this.stateFlags.fill(0);
        this.transform.fill(0);
        this.physics.fill(0);
        this.pigment.fill(0);
        this.stats.fill(0);
        this.input.fill(0);
        this.skill.fill(0);
        this.config.fill(0);
        this.projectile.fill(0);
        this.tattoo.fill(0);
    }

    /**
     * Check if entity ID is valid
     */
    isValidEntityId(id: number): boolean {
        return id >= 0 && id < this.maxEntities;
    }
}

// STRIDES in floats (for array indexing, not bytes)
export const STRIDES = {
    TRANSFORM: 8,
    PHYSICS: 8,
    PIGMENT: 8,
    STATS: 8,
    INPUT: 4,
    SKILL: 4,
    CONFIG: 8,
    PROJECTILE: 4,
    TATTOO: 4,
} as const;

/**
 * Default global WorldState instance.
 * Used for backward compatibility with static Store classes.
 * @deprecated Prefer injecting WorldState instances for new code.
 */
export const defaultWorld = new WorldState();

// EIDOLON-V P6: Runtime deprecation warning
declare const __DEV__: boolean | undefined;
if (typeof console !== 'undefined' && typeof __DEV__ !== 'undefined' && __DEV__) {
  console.warn('[EIDOLON-V] defaultWorld singleton is deprecated. Use new WorldState() for instance-based architecture.');
}
